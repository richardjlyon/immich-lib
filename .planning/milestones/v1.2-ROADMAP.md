# Milestone v1.2: Configuration UX

**Status:** âœ… SHIPPED 2025-12-28
**Phases:** 11
**Total Plans:** 2

## Overview

Add config file support with OS-native location, interactive setup prompts, and credential persistence. Improves UX by eliminating repetitive credential entry.

## Phases

### Phase 11: Configuration UX

**Goal**: Config file support with OS-native location, interactive setup, and credential persistence
**Depends on**: v1.1 milestone complete
**Plans**: 2 plans

Plans:

- [x] 11-01: Config Module (directories + toml, load/save, CLI integration)
- [x] 11-02: Interactive Setup (dialoguer prompts, --save flag, credential persistence)

**Details:**

**11-01: Config Module**
- Config module with load/save functions using TOML format
- OS-native config paths (macOS: ~/Library/Application Support, Linux: ~/.config, Windows: AppData/Roaming)
- CLI credential resolution: CLI args > env vars > config file > error
- Atomic file writes with temp file + rename pattern
- Used directory structure `src/bin/immich_dupes/` for binary with submodules

**11-02: Interactive Setup**
- Added dialoguer dependency for interactive terminal prompts
- Implemented prompt_credentials() with URL validation and hidden API key input
- Implemented prompt_save() to offer credential persistence
- Added global --save flag to force save prompt with CLI args
- Credentials only saved after successful command execution

---

## Milestone Summary

**Key Decisions:**

- Directory structure for binary: src/bin/immich_dupes/ with main.rs + modules (Rust pattern)
- TOML config format (human-readable, matches Rust ecosystem conventions)
- directories crate for OS paths (macOS/Linux/Windows native config locations)
- dialoguer for prompts (mature crate, 41M+ downloads, ColorfulTheme for terminal styling)
- Save after success only (credential save offered after command completes successfully)

**Issues Resolved:**

- Initial approach of placing config.rs in src/bin/ caused Cargo to treat it as a separate binary. Restructured to use standard Rust pattern.

**Issues Deferred:**

None.

**Technical Debt Incurred:**

None.

---

_For current project status, see .planning/ROADMAP.md_
